<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">
    <link href="/styles.css" rel="stylesheet">
    <title>The Kraaij-Pohlmann stemming algorithm</title>
  </head>

  <body bgcolor="white">
    <h1>The Kraaij-Pohlmann stemming algorithm</h1>
<TABLE WIDTH=75% ALIGN=CENTER COLS=1>
<H1 ALIGN=CENTER>The Kraaij-Pohlmann stemming algorithm</H1>

<TR><TD>
<BR>&nbsp;<H2>Links to resources</H2>

<DL><DD><TABLE CELLPADDING=0>
<TR><TD><A HREF="../.."> Snowball main page</A>
<TR><TD><A HREF="stem_ISO_8859_1.sbl">    The stemmer in Snowball</A>
<TR><TD><A HREF="stem.c">      The ANSI C stemmer</A>
<TR><TD><A HREF="stem.h">      &#x2014; and its header</A>
<TR><TD><A HREF="voc.txt">     Sample vocabulary</A>
<TR><TD><A HREF="output.txt">  Its stemmed equivalent</A>
<BR><BR>
<TR><TD><A HREF="http://www-uilots.let.uu.nl/uplift">
The UPLIFT project page, from where the original stemmer can be downloaded</A>
</TABLE></DL>

The Kraaij-Pohlmann stemming algorithm is an ANSI C program for stemming in Dutch. Although
advertised as an algorithm, it is in fact a program without an accompanying
algorithmic description. It is possible to produce a fairly clean Snowball
version, but only by sacrificing exact functional equivalence. But that does not
matter too much, since in the demonstration vocabulary only 32 words out of over
45,000 stem differently. Here they are:

<DL><DD><TABLE CELLPADDING=0>
<TR><TD>
<B>source</B>           <TD></TD><TD><B>ANSI C stemmer</B>       <TD></TD><TD> <B>Snowball stemmer</B>
<TR><TD> airways           <TD></TD><TD>         airways         <TD></TD><TD>            airway
<TR><TD> algerije          <TD></TD><TD>         algerije        <TD></TD><TD>            alrije
<TR><TD> assays            <TD></TD><TD>         assays          <TD></TD><TD>            assay
<TR><TD> bruys             <TD></TD><TD>         bruys           <TD></TD><TD>            bruy
<TR><TD> cleanaways        <TD></TD><TD>         cleanaways      <TD></TD><TD>            cleanaway
<TR><TD> creys             <TD></TD><TD>         creys           <TD></TD><TD>            crey
<TR><TD> croyden           <TD></TD><TD>         croyd           <TD></TD><TD>            croy
<TR><TD> edele             <TD></TD><TD>         edel            <TD></TD><TD>            edeel
<TR><TD> essays            <TD></TD><TD>         essays          <TD></TD><TD>            essay
<TR><TD> gedijen           <TD></TD><TD>         gedij           <TD></TD><TD>            dij
<TR><TD> geoff             <TD></TD><TD>         of              <TD></TD><TD>            off
<TR><TD> gevrey            <TD></TD><TD>         gevrey          <TD></TD><TD>            vrey
<TR><TD> geysels           <TD></TD><TD>         ysel            <TD></TD><TD>            gey
<TR><TD> grootmeesteres    <TD></TD><TD>         grootmee        <TD></TD><TD>            grootmeest
<TR><TD> gr•otmeesteres    <TD></TD><TD>         gr•otmee        <TD></TD><TD>            gr•otmeest
<TR><TD> hectares          <TD></TD><TD>         hectaar         <TD></TD><TD>            hect
<TR><TD> huys              <TD></TD><TD>         huys            <TD></TD><TD>            huy
<TR><TD> kayen             <TD></TD><TD>         kayen           <TD></TD><TD>            kaay
<TR><TD> lagerwey          <TD></TD><TD>         lagerwey        <TD></TD><TD>            larwey
<TR><TD> mayen             <TD></TD><TD>         mayen           <TD></TD><TD>            maay
<TR><TD> meesteres         <TD></TD><TD>         meester         <TD></TD><TD>            meest
<TR><TD> oppasseres        <TD></TD><TD>         oppasser        <TD></TD><TD>            oppas
<TR><TD> pays              <TD></TD><TD>         pays            <TD></TD><TD>            pay
<TR><TD> royale            <TD></TD><TD>         royale          <TD></TD><TD>            royaal
<TR><TD> schilderes        <TD></TD><TD>         schilder        <TD></TD><TD>            schild
<TR><TD> summerhayes       <TD></TD><TD>         summerhayes     <TD></TD><TD>            summerhaye
<TR><TD> tyumen            <TD></TD><TD>         tyuum           <TD></TD><TD>            tyum
<TR><TD> verheyen          <TD></TD><TD>         verheyen        <TD></TD><TD>            verheey
<TR><TD> verleideres       <TD></TD><TD>         verleider       <TD></TD><TD>            verleid
<TR><TD> ytsen             <TD></TD><TD>         yts             <TD></TD><TD>            ytsen
<TR><TD> yves              <TD></TD><TD>         yve             <TD></TD><TD>            yves
<TR><TD> zangeres          <TD></TD><TD>         zanger          <TD></TD><TD>            zang
</TABLE></DL>

The Kraaij-Pohmann stemmer can make fairly drastic reductions to a word. For
example, infixed <B><I>ge</I></B> is removed, so <I>geluidgevoelige</I> stems to
<I>luidvoel</I>. Often, therefore, the original word cannot be easily guessed from
the stemmed form.
<BR><BR>
Here then is the Snowball equivalent of the Kraaij-Pohlmann algorithm.
<BR><BR>
<TR><TD>

<div class="highlight"><pre><span class="kd">strings</span> <span class="p">(</span> <span class="n">ch</span> <span class="p">)</span>
<span class="kd">integers</span> <span class="p">(</span> <span class="n">x</span> <span class="n">p1</span> <span class="n">p2</span> <span class="p">)</span>
<span class="kd">booleans</span> <span class="p">(</span> <span class="n">Y_found</span> <span class="n">stemmed</span> <span class="n">GE_removed</span> <span class="p">)</span>

<span class="kd">routines</span> <span class="p">(</span>

   <span class="n">R1</span> <span class="n">R2</span>
   <span class="n">C</span> <span class="n">V</span> <span class="n">VX</span>
   <span class="n">lengthen_V</span>
   <span class="n">Step_1</span> <span class="n">Step_2</span> <span class="n">Step_3</span> <span class="n">Step_4</span> <span class="n">Step_7</span>
   <span class="n">Step_6</span> <span class="n">Step_1c</span>
   <span class="n">Lose_prefix</span>
   <span class="n">Lose_infix</span>
   <span class="n">measure</span>
<span class="p">)</span>

<span class="kd">externals</span> <span class="p">(</span> <span class="n">stem</span> <span class="p">)</span>

<span class="kd">groupings</span> <span class="p">(</span> <span class="n">v</span> <span class="n">v_WX</span> <span class="n">AOU</span> <span class="n">AIOU</span> <span class="p">)</span>

<span class="kd">stringescapes</span> <span class="p">{}</span>

<span class="kd">stringdef</span> <span class="n">&#39;</span>   <span class="mh">hex</span> <span class="s">&#39;27&#39;</span>  <span class="c1">// yuk</span>

<span class="kd">define</span> <span class="n">v</span>        <span class="s">&#39;aeiouy&#39;</span>
<span class="kd">define</span> <span class="n">v_WX</span>     <span class="n">v</span> <span class="o">+</span> <span class="s">&#39;wx&#39;</span>
<span class="kd">define</span> <span class="n">AOU</span>      <span class="s">&#39;aou&#39;</span>
<span class="kd">define</span> <span class="n">AIOU</span>     <span class="s">&#39;aiou&#39;</span>

<span class="kd">backwardmode</span> <span class="p">(</span>

    <span class="kd">define</span> <span class="n">R1</span> <span class="k">as</span> <span class="p">(</span><span class="ow">setmark</span> <span class="n">x</span> <span class="o">$</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">p1</span><span class="p">)</span>
    <span class="kd">define</span> <span class="n">R2</span> <span class="k">as</span> <span class="p">(</span><span class="ow">setmark</span> <span class="n">x</span> <span class="o">$</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">p2</span><span class="p">)</span>

    <span class="kd">define</span> <span class="n">V</span>  <span class="k">as</span> <span class="ow">test</span> <span class="p">(</span><span class="n">v</span> <span class="ow">or</span> <span class="s">&#39;ij&#39;</span><span class="p">)</span>
    <span class="kd">define</span> <span class="n">VX</span> <span class="k">as</span> <span class="ow">test</span> <span class="p">(</span><span class="ow">next</span> <span class="n">v</span> <span class="ow">or</span> <span class="s">&#39;ij&#39;</span><span class="p">)</span>
    <span class="kd">define</span> <span class="n">C</span>  <span class="k">as</span> <span class="ow">test</span> <span class="p">(</span><span class="ow">not</span> <span class="s">&#39;ij&#39;</span> <span class="ow">non-</span><span class="n">v</span><span class="p">)</span>

    <span class="kd">define</span> <span class="n">lengthen_V</span> <span class="k">as</span> <span class="ow">do</span> <span class="p">(</span>
        <span class="ow">non-</span><span class="n">v_WX</span> <span class="p">[</span> <span class="p">(</span><span class="n">AOU</span><span class="p">]</span> <span class="ow">test</span> <span class="p">(</span><span class="ow">non-</span><span class="n">v</span> <span class="ow">or</span> <span class="ow">atlimit</span><span class="p">))</span> <span class="ow">or</span>
                   <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">]</span> <span class="ow">test</span> <span class="p">(</span><span class="ow">non-</span><span class="n">v</span> <span class="ow">or</span> <span class="ow">atlimit</span>
                               <span class="ow">not</span> <span class="n">AIOU</span>
                               <span class="ow">not</span> <span class="p">(</span><span class="ow">next</span> <span class="n">AIOU</span> <span class="ow">non-</span><span class="n">v</span><span class="p">)))</span>
        <span class="o">-&gt;</span><span class="n">ch</span> <span class="ow">insert</span> <span class="n">ch</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_1</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>

            <span class="s">&#39;{&#39;}s&#39;</span> <span class="p">(</span><span class="ow">delete</span><span class="p">)</span>
            <span class="s">&#39;s&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="ow">not</span> <span class="p">(</span><span class="s">&#39;t&#39;</span> <span class="n">R1</span><span class="p">)</span> <span class="n">C</span> <span class="ow">delete</span><span class="p">)</span>
            <span class="s">&#39;ies&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;ie&#39;</span><span class="p">)</span>
            <span class="s">&#39;es&#39;</span>
                   <span class="p">((</span><span class="s">&#39;ar&#39;</span> <span class="n">R1</span> <span class="n">C</span> <span class="p">]</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;er&#39;</span> <span class="n">R1</span> <span class="n">C</span> <span class="p">]</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="o">&lt;-</span><span class="s">&#39;e&#39;</span><span class="p">))</span>

            <span class="s">&#39;aus&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="n">V</span> <span class="o">&lt;-</span><span class="s">&#39;au&#39;</span><span class="p">)</span>
            <span class="s">&#39;en&#39;</span>   <span class="p">((</span><span class="s">&#39;hed&#39;</span> <span class="n">R1</span> <span class="p">]</span> <span class="o">&lt;-</span><span class="s">&#39;heid&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;nd&#39;</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;d&#39;</span> <span class="n">R1</span> <span class="n">C</span> <span class="p">]</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;i&#39;</span> <span class="ow">or</span> <span class="s">&#39;j&#39;</span> <span class="n">V</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">))</span>
            <span class="s">&#39;nde&#39;</span>  <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;nd&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_2</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
            <span class="s">&#39;je&#39;</span>   <span class="p">((</span><span class="s">&#39;{&#39;}t&#39;</span> <span class="p">]</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;et&#39;</span>   <span class="p">]</span> <span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;rnt&#39;</span>  <span class="p">]</span> <span class="o">&lt;-</span><span class="s">&#39;rn&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;t&#39;</span>    <span class="p">]</span> <span class="n">R1</span> <span class="n">VX</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;ink&#39;</span>  <span class="p">]</span> <span class="o">&lt;-</span><span class="s">&#39;ing&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;mp&#39;</span>   <span class="p">]</span> <span class="o">&lt;-</span><span class="s">&#39;m&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;{&#39;}&#39;</span>  <span class="p">]</span> <span class="n">R1</span> <span class="ow">delete</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(]</span> <span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span><span class="p">))</span>
            <span class="s">&#39;ge&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
            <span class="s">&#39;lijke&#39;</span><span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;lijk&#39;</span><span class="p">)</span>
            <span class="s">&#39;ische&#39;</span><span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;isch&#39;</span><span class="p">)</span>
            <span class="s">&#39;de&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span><span class="p">)</span>
            <span class="s">&#39;te&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
            <span class="s">&#39;se&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
            <span class="s">&#39;re&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="s">&#39;le&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span> <span class="ow">attach</span> <span class="s">&#39;l&#39;</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;ene&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span> <span class="ow">attach</span> <span class="s">&#39;en&#39;</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;ieve&#39;</span> <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="o">&lt;-</span><span class="s">&#39;ief&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_3</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
            <span class="s">&#39;atie&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;eer&#39;</span><span class="p">)</span>
            <span class="s">&#39;iteit&#39;</span> <span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;heid&#39;</span>
            <span class="s">&#39;sel&#39;</span>
            <span class="s">&#39;ster&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span><span class="p">)</span>
            <span class="s">&#39;rder&#39;</span>  <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="s">&#39;ing&#39;</span>
            <span class="s">&#39;isme&#39;</span>
            <span class="s">&#39;erij&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;arij&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="o">&lt;-</span><span class="s">&#39;aar&#39;</span><span class="p">)</span>
            <span class="s">&#39;fie&#39;</span>   <span class="p">(</span><span class="n">R2</span> <span class="ow">delete</span> <span class="ow">attach</span> <span class="s">&#39;f&#39;</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;gie&#39;</span>   <span class="p">(</span><span class="n">R2</span> <span class="ow">delete</span> <span class="ow">attach</span> <span class="s">&#39;g&#39;</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="s">&#39;tst&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="o">&lt;-</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
            <span class="s">&#39;dst&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="o">&lt;-</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_4</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">(</span>   <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
                <span class="s">&#39;ioneel&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;ie&#39;</span><span class="p">)</span>
                <span class="s">&#39;atief&#39;</span>   <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;eer&#39;</span><span class="p">)</span>
                <span class="s">&#39;baar&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span><span class="p">)</span>
                <span class="s">&#39;naar&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="n">V</span> <span class="o">&lt;-</span><span class="s">&#39;n&#39;</span><span class="p">)</span>
                <span class="s">&#39;laar&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="n">V</span> <span class="o">&lt;-</span><span class="s">&#39;l&#39;</span><span class="p">)</span>
                <span class="s">&#39;raar&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="n">V</span> <span class="o">&lt;-</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
                <span class="s">&#39;tant&#39;</span>    <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;teer&#39;</span><span class="p">)</span>
                <span class="s">&#39;lijker&#39;</span>
                <span class="s">&#39;lijkst&#39;</span>  <span class="p">(</span><span class="n">R1</span> <span class="o">&lt;-</span><span class="s">&#39;lijk&#39;</span><span class="p">)</span>
                <span class="s">&#39;achtig&#39;</span>
                <span class="s">&#39;achtiger&#39;</span>
                <span class="s">&#39;achtigst&#39;</span><span class="p">(</span><span class="n">R1</span> <span class="ow">delete</span><span class="p">)</span>
                <span class="s">&#39;eriger&#39;</span>
                <span class="s">&#39;erigst&#39;</span>
                <span class="s">&#39;erig&#39;</span>
                <span class="s">&#39;end&#39;</span>     <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="ow">or</span>
        <span class="p">(</span>   <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
                <span class="s">&#39;iger&#39;</span>
                <span class="s">&#39;igst&#39;</span>
                <span class="s">&#39;ig&#39;</span>      <span class="p">(</span><span class="n">R1</span> <span class="n">C</span> <span class="ow">delete</span> <span class="n">lengthen_V</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_7</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
            <span class="s">&#39;kt&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="s">&#39;ft&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
            <span class="s">&#39;pt&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;p&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_6</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(])</span>
            <span class="s">&#39;bb&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
            <span class="s">&#39;cc&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;c&#39;</span><span class="p">)</span>
            <span class="s">&#39;dd&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;d&#39;</span><span class="p">)</span>
            <span class="s">&#39;ff&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
            <span class="s">&#39;gg&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
            <span class="s">&#39;hh&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;h&#39;</span><span class="p">)</span>
            <span class="s">&#39;jj&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;j&#39;</span><span class="p">)</span>
            <span class="s">&#39;kk&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="s">&#39;ll&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;l&#39;</span><span class="p">)</span>
            <span class="s">&#39;mm&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;m&#39;</span><span class="p">)</span>
            <span class="s">&#39;nn&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;n&#39;</span><span class="p">)</span>
            <span class="s">&#39;pp&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;p&#39;</span><span class="p">)</span>
            <span class="s">&#39;qq&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;q&#39;</span><span class="p">)</span>
            <span class="s">&#39;rr&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="s">&#39;ss&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
            <span class="s">&#39;tt&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
            <span class="s">&#39;vv&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
            <span class="s">&#39;ww&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="s">&#39;xx&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
            <span class="s">&#39;zz&#39;</span>   <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
            <span class="s">&#39;v&#39;</span>    <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
            <span class="s">&#39;z&#39;</span>    <span class="p">(</span><span class="o">&lt;-</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="kd">define</span> <span class="n">Step_1c</span> <span class="k">as</span>
    <span class="p">(</span>
        <span class="p">[</span><span class="k">among</span> <span class="p">(</span> <span class="p">(]</span> <span class="n">R1</span> <span class="n">C</span><span class="p">)</span>
            <span class="s">&#39;d&#39;</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="s">&#39;n&#39;</span> <span class="n">R1</span><span class="p">)</span> <span class="ow">delete</span><span class="p">)</span>
            <span class="s">&#39;t&#39;</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="s">&#39;h&#39;</span> <span class="n">R1</span><span class="p">)</span> <span class="ow">delete</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="kd">define</span> <span class="n">Lose_prefix</span> <span class="k">as</span> <span class="p">(</span>
    <span class="p">[</span><span class="s">&#39;ge&#39;</span><span class="p">]</span> <span class="ow">test</span> <span class="ow">hop</span> <span class="m">3</span> <span class="p">(</span><span class="ow">goto</span> <span class="n">v</span> <span class="ow">goto</span> <span class="ow">non-</span><span class="n">v</span><span class="p">)</span>
    <span class="ow">set</span> <span class="n">GE_removed</span>
    <span class="ow">delete</span>
<span class="p">)</span>

<span class="kd">define</span> <span class="n">Lose_infix</span> <span class="k">as</span> <span class="p">(</span>
    <span class="ow">next</span>
    <span class="ow">gopast</span> <span class="p">([</span><span class="s">&#39;ge&#39;</span><span class="p">])</span> <span class="ow">test</span> <span class="ow">hop</span> <span class="m">3</span> <span class="p">(</span><span class="ow">goto</span> <span class="n">v</span> <span class="ow">goto</span> <span class="ow">non-</span><span class="n">v</span><span class="p">)</span>
    <span class="ow">set</span> <span class="n">GE_removed</span>
    <span class="ow">delete</span>
<span class="p">)</span>

<span class="kd">define</span> <span class="n">measure</span> <span class="k">as</span> <span class="p">(</span>
    <span class="ow">do</span> <span class="p">(</span>
        <span class="ow">tolimit</span>
        <span class="ow">setmark</span> <span class="n">p1</span>
        <span class="ow">setmark</span> <span class="n">p2</span>
    <span class="p">)</span>
    <span class="ow">do</span><span class="p">(</span>
        <span class="ow">repeat</span> <span class="ow">non-</span><span class="n">v</span>  <span class="ow">atleast</span> <span class="m">1</span> <span class="p">(</span><span class="s">&#39;ij&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="p">)</span>  <span class="ow">non-</span><span class="n">v</span>  <span class="ow">setmark</span> <span class="n">p1</span>
        <span class="ow">repeat</span> <span class="ow">non-</span><span class="n">v</span>  <span class="ow">atleast</span> <span class="m">1</span> <span class="p">(</span><span class="s">&#39;ij&#39;</span> <span class="ow">or</span> <span class="n">v</span><span class="p">)</span>  <span class="ow">non-</span><span class="n">v</span>  <span class="ow">setmark</span> <span class="n">p2</span>
    <span class="p">)</span>

<span class="p">)</span>
<span class="kd">define</span> <span class="n">stem</span> <span class="k">as</span> <span class="p">(</span>

    <span class="ow">unset</span> <span class="n">Y_found</span>
    <span class="ow">unset</span> <span class="n">stemmed</span>
    <span class="ow">do</span> <span class="p">(</span> <span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">&lt;-</span><span class="s">&#39;Y&#39;</span> <span class="ow">set</span> <span class="n">Y_found</span> <span class="p">)</span>
    <span class="ow">do</span> <span class="ow">repeat</span><span class="p">(</span><span class="ow">goto</span> <span class="p">(</span><span class="n">v</span>  <span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span><span class="o">&lt;-</span><span class="s">&#39;Y&#39;</span> <span class="ow">set</span> <span class="n">Y_found</span> <span class="p">)</span>

    <span class="n">measure</span>

    <span class="ow">backwards</span> <span class="p">(</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">Step_1</span> <span class="ow">set</span> <span class="n">stemmed</span> <span class="p">)</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">Step_2</span> <span class="ow">set</span> <span class="n">stemmed</span> <span class="p">)</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">Step_3</span> <span class="ow">set</span> <span class="n">stemmed</span> <span class="p">)</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">Step_4</span> <span class="ow">set</span> <span class="n">stemmed</span> <span class="p">)</span>
    <span class="p">)</span>
    <span class="ow">unset</span> <span class="n">GE_removed</span>
    <span class="ow">do</span> <span class="p">(</span><span class="n">Lose_prefix</span> <span class="ow">and</span> <span class="n">measure</span><span class="p">)</span>
    <span class="ow">backwards</span> <span class="p">(</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">GE_removed</span> <span class="n">Step_1c</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="ow">unset</span> <span class="n">GE_removed</span>
    <span class="ow">do</span> <span class="p">(</span><span class="n">Lose_infix</span> <span class="ow">and</span> <span class="n">measure</span><span class="p">)</span>
    <span class="ow">backwards</span> <span class="p">(</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">GE_removed</span> <span class="n">Step_1c</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="ow">backwards</span> <span class="p">(</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">Step_7</span> <span class="ow">set</span> <span class="n">stemmed</span> <span class="p">)</span>
            <span class="ow">do</span> <span class="p">(</span><span class="n">stemmed</span> <span class="ow">or</span> <span class="n">GE_removed</span> <span class="n">Step_6</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="ow">do</span><span class="p">(</span><span class="n">Y_found</span>  <span class="ow">repeat</span><span class="p">(</span><span class="ow">goto</span> <span class="p">([</span><span class="s">&#39;Y&#39;</span><span class="p">])</span> <span class="o">&lt;-</span><span class="s">&#39;y&#39;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>

</TR>

</TABLE>
  </body>
</html>
